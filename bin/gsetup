#!/usr/bin/env bash
function setup {
    remote=$1
    exists=$(git ls-remote --heads $remote | grep refs/heads/$local | wc -l)
    if [[ $exists -eq 0 ]]; then
        read -p "Create $remote/$local? [y/n]: " yesno
        if [[ ${yesno} == 'y' ]]; then
            git push $remote HEAD:$local
        fi
    fi
    read -p "Set upstream to $remote/$local? [y/n]: " yesno
    if [[ ${yesno} != 'y' ]]; then
            return
    fi
    git branch --set-upstream-to=${remote}/${local}
    exit 0
}

local=$(git branch --verbose --show-current)

for up in $(git remote); do
    setup $up
done
exit 1
